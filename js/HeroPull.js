import { EventEmitter } from './core.js';
import { HeroesGrid } from './heroesGrid.js';
let parentSelector = '#heropull';
// const pullListCN = 'hero-pull-list';
// const _pullList = `<div class="${pullListCN}"></div>`;
// const pullItemCN = 'hero-pull-list__item';
// const _pullItem = `<div class="${pullItemCN}"></div>`;
const disabledGridCN = 'heroes-grid_disabled';
const disabledHeroInGridCN = 'heroes-grid__col_disabled';
class HeroPullModel extends EventEmitter {
    constructor(players) {
        super();
        this.heroesGrid = new HeroesGrid({ parent: parentSelector });
        this.pull = [];
        this.step = 0;
        this.players = players;
    }
    get currPlayer() {
        return this.players[this.step];
    }
    get pullEnded() {
        return this.step > this.players.length - 1;
    }
    addPull(hero) {
        this.pull.push(hero);
    }
}
class HeroPullView extends EventEmitter {
    constructor(model) {
        super();
        this.elem = {
            $wrap: $(parentSelector),
        };
        this._model = model;
        model.heroesGrid.on('click', opt => {
            if (!$(opt.event.currentTarget).hasClass(disabledHeroInGridCN))
                this.emit('pullHero', opt.hero.id);
        });
    }
    disableHeroInGrid(id) {
        const $grid = this._model.heroesGrid.$gridElem;
        const $target = $grid.find(`[data-id="${id}"]`);
        $target.addClass(disabledHeroInGridCN);
    }
    // addHeroInPullList(id: string) {
    //     const $grid = this._model.heroesGrid.$gridElem;
    //     const $clone = $grid.find(`[data-id="${id}"]`).children().clone();
    //     const $li = this.elem.$list.children();
    //     const step = this._model.step;
    //     $li.eq(step).append($clone);
    // }
    disableGrid(cond) {
        const $grid = this._model.heroesGrid.$gridElem;
        if (cond)
            $grid.addClass(disabledGridCN);
        else
            $grid.removeClass(disabledGridCN);
    }
    render() {
        // const $list = this.elem.$list;
        // this.elem.$wrap.prepend($list);
        // this._model.players.forEach(name => $list.append($(_pullItem)));
    }
}
class HeroPullController {
    constructor(model, view) {
        this.pull = function (currPlayer) { };
        this.pullEnd = function (pull) { };
        this.click = function (hero) { };
        this._model = model;
        this._view = view;
        view.on('pullHero', (id) => this.pullHero(id));
    }
    pullHero(id) {
        const view = this._view;
        const model = this._model;
        const hero = model.heroesGrid.getHero(id);
        view.disableHeroInGrid(id);
        // view.addHeroInPullList(id);
        this.click(hero);
        model.step++;
        model.addPull(hero);
        if (model.pullEnded) {
            view.disableGrid(model.pullEnded);
            model.heroesGrid.view.setTarget(null);
            this.pullEnd(this._model.pull);
        }
        else {
            this.pull(model.currPlayer);
        }
    }
}
export class HeroPull {
    constructor(players) {
        this.model = new HeroPullModel(players);
        this.view = new HeroPullView(this.model);
        this.controller = new HeroPullController(this.model, this.view);
        this.view.render();
    }
    on(event, callback) {
        this.controller[event] = callback;
        return this;
    }
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,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Q0FBQztDQUNKO0FBRUQsTUFBTSxPQUFPLFFBQVE7SUFLakIsWUFBWSxPQUFpQjtRQUN6QixJQUFJLENBQUMsS0FBSyxHQUFRLElBQUksYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQzdDLElBQUksQ0FBQyxJQUFJLEdBQVMsSUFBSSxZQUFZLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQy9DLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUVoRSxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDO0lBQ3ZCLENBQUM7SUFFRCxFQUFFLENBQUMsS0FBYSxFQUFFLFFBQWtCO1FBQ2hDLElBQUksQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLEdBQUcsUUFBUSxDQUFDO1FBQ2xDLE9BQU8sSUFBSSxDQUFDO0lBQ2hCLENBQUM7Q0FDSiIsImZpbGUiOiJoZXJvUHVsbC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEV2ZW50RW1pdHRlciB9IGZyb20gJy4vY29yZS5qcyc7XHJcbmltcG9ydCB7IEhlcm9lc0dyaWQgfSBmcm9tICcuL2hlcm9lc0dyaWQuanMnO1xyXG5pbXBvcnQgeyBIZXJvIH0gZnJvbSAnLi90eXBlcyc7XHJcblxyXG5sZXQgcGFyZW50U2VsZWN0b3IgPSAnI2hlcm9wdWxsJztcclxuXHJcbi8vIGNvbnN0IHB1bGxMaXN0Q04gPSAnaGVyby1wdWxsLWxpc3QnO1xyXG4vLyBjb25zdCBfcHVsbExpc3QgPSBgPGRpdiBjbGFzcz1cIiR7cHVsbExpc3RDTn1cIj48L2Rpdj5gO1xyXG5cclxuLy8gY29uc3QgcHVsbEl0ZW1DTiA9ICdoZXJvLXB1bGwtbGlzdF9faXRlbSc7XHJcbi8vIGNvbnN0IF9wdWxsSXRlbSA9IGA8ZGl2IGNsYXNzPVwiJHtwdWxsSXRlbUNOfVwiPjwvZGl2PmA7XHJcblxyXG5jb25zdCBkaXNhYmxlZEdyaWRDTiA9ICdoZXJvZXMtZ3JpZF9kaXNhYmxlZCc7XHJcbmNvbnN0IGRpc2FibGVkSGVyb0luR3JpZENOID0gJ2hlcm9lcy1ncmlkX19jb2xfZGlzYWJsZWQnO1xyXG5cclxuY2xhc3MgSGVyb1B1bGxNb2RlbCBleHRlbmRzIEV2ZW50RW1pdHRlciB7XHJcbiAgICBoZXJvZXNHcmlkID0gbmV3IEhlcm9lc0dyaWQoe3BhcmVudDogcGFyZW50U2VsZWN0b3J9KTtcclxuICAgIHB1bGw6IEhlcm9bXSA9IFtdO1xyXG4gICAgcGxheWVyczogc3RyaW5nW107XHJcbiAgICBzdGVwID0gMDtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihwbGF5ZXJzOiBzdHJpbmdbXSkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcblxyXG4gICAgICAgIHRoaXMucGxheWVycyA9IHBsYXllcnM7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IGN1cnJQbGF5ZXIoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wbGF5ZXJzW3RoaXMuc3RlcF07XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IHB1bGxFbmRlZCgpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zdGVwID4gdGhpcy5wbGF5ZXJzLmxlbmd0aCAtIDE7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkUHVsbChoZXJvOiBIZXJvKSB7XHJcbiAgICAgICAgdGhpcy5wdWxsLnB1c2goaGVybyk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmNsYXNzIEhlcm9QdWxsVmlldyBleHRlbmRzIEV2ZW50RW1pdHRlciB7XHJcbiAgICBfbW9kZWw6IEhlcm9QdWxsTW9kZWw7XHJcblxyXG4gICAgZWxlbSA9IHtcclxuICAgICAgICAkd3JhcDogJChwYXJlbnRTZWxlY3RvciksXHJcbiAgICAgICAgLy8gJGxpc3Q6ICQoX3B1bGxMaXN0KVxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihtb2RlbDogSGVyb1B1bGxNb2RlbCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcblxyXG4gICAgICAgIHRoaXMuX21vZGVsID0gbW9kZWw7XHJcblxyXG4gICAgICAgIG1vZGVsLmhlcm9lc0dyaWQub24oJ2NsaWNrJywgb3B0ID0+IHtcclxuICAgICAgICAgICAgaWYgKCAhJChvcHQuZXZlbnQuY3VycmVudFRhcmdldCkuaGFzQ2xhc3MoZGlzYWJsZWRIZXJvSW5HcmlkQ04pICkgdGhpcy5lbWl0KCdwdWxsSGVybycsIG9wdC5oZXJvLmlkKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBkaXNhYmxlSGVyb0luR3JpZChpZDogc3RyaW5nKSB7XHJcbiAgICAgICAgY29uc3QgJGdyaWQgPSB0aGlzLl9tb2RlbC5oZXJvZXNHcmlkLiRncmlkRWxlbTtcclxuICAgICAgICBjb25zdCAkdGFyZ2V0ID0gJGdyaWQuZmluZChgW2RhdGEtaWQ9XCIke2lkfVwiXWApO1xyXG5cclxuICAgICAgICAkdGFyZ2V0LmFkZENsYXNzKGRpc2FibGVkSGVyb0luR3JpZENOKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBhZGRIZXJvSW5QdWxsTGlzdChpZDogc3RyaW5nKSB7XHJcbiAgICAvLyAgICAgY29uc3QgJGdyaWQgPSB0aGlzLl9tb2RlbC5oZXJvZXNHcmlkLiRncmlkRWxlbTtcclxuICAgIC8vICAgICBjb25zdCAkY2xvbmUgPSAkZ3JpZC5maW5kKGBbZGF0YS1pZD1cIiR7aWR9XCJdYCkuY2hpbGRyZW4oKS5jbG9uZSgpO1xyXG4gICAgLy8gICAgIGNvbnN0ICRsaSA9IHRoaXMuZWxlbS4kbGlzdC5jaGlsZHJlbigpO1xyXG5cclxuICAgIC8vICAgICBjb25zdCBzdGVwID0gdGhpcy5fbW9kZWwuc3RlcDtcclxuXHJcbiAgICAvLyAgICAgJGxpLmVxKHN0ZXApLmFwcGVuZCgkY2xvbmUpO1xyXG4gICAgLy8gfVxyXG5cclxuICAgIGRpc2FibGVHcmlkKGNvbmQ6IGJvb2xlYW4pIHtcclxuICAgICAgICBjb25zdCAkZ3JpZCA9IHRoaXMuX21vZGVsLmhlcm9lc0dyaWQuJGdyaWRFbGVtO1xyXG5cclxuICAgICAgICBpZiAoY29uZCkgJGdyaWQuYWRkQ2xhc3MoZGlzYWJsZWRHcmlkQ04pO1xyXG4gICAgICAgIGVsc2UgJGdyaWQucmVtb3ZlQ2xhc3MoZGlzYWJsZWRHcmlkQ04pO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICAvLyBjb25zdCAkbGlzdCA9IHRoaXMuZWxlbS4kbGlzdDtcclxuICAgICAgICAvLyB0aGlzLmVsZW0uJHdyYXAucHJlcGVuZCgkbGlzdCk7XHJcblxyXG4gICAgICAgIC8vIHRoaXMuX21vZGVsLnBsYXllcnMuZm9yRWFjaChuYW1lID0+ICRsaXN0LmFwcGVuZCgkKF9wdWxsSXRlbSkpKTtcclxuICAgIH1cclxufVxyXG5cclxuY2xhc3MgSGVyb1B1bGxDb250cm9sbGVyIHtcclxuICAgIF9tb2RlbDogSGVyb1B1bGxNb2RlbDtcclxuICAgIF92aWV3OiBIZXJvUHVsbFZpZXc7XHJcblxyXG4gICAgcHVsbCA9IGZ1bmN0aW9uKGN1cnJQbGF5ZXI6IHN0cmluZykge307XHJcbiAgICBwdWxsRW5kID0gZnVuY3Rpb24ocHVsbDogSGVyb1tdKSB7fTtcclxuICAgIGNsaWNrID0gZnVuY3Rpb24oaGVybzogSGVybykge307XHJcblxyXG4gICAgY29uc3RydWN0b3IobW9kZWw6IEhlcm9QdWxsTW9kZWwsIHZpZXc6IEhlcm9QdWxsVmlldykge1xyXG4gICAgICAgIHRoaXMuX21vZGVsID0gbW9kZWw7XHJcbiAgICAgICAgdGhpcy5fdmlldyA9IHZpZXc7XHJcblxyXG4gICAgICAgIHZpZXcub24oJ3B1bGxIZXJvJywgKGlkOiBzdHJpbmcpID0+IHRoaXMucHVsbEhlcm8oaWQpKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWxsSGVybyhpZDogc3RyaW5nKSB7XHJcbiAgICAgICAgY29uc3QgdmlldyA9IHRoaXMuX3ZpZXc7XHJcbiAgICAgICAgY29uc3QgbW9kZWwgPSB0aGlzLl9tb2RlbDtcclxuXHJcbiAgICAgICAgY29uc3QgaGVybyA9IG1vZGVsLmhlcm9lc0dyaWQuZ2V0SGVybyhpZCk7XHJcblxyXG4gICAgICAgIHZpZXcuZGlzYWJsZUhlcm9JbkdyaWQoaWQpO1xyXG4gICAgICAgIC8vIHZpZXcuYWRkSGVyb0luUHVsbExpc3QoaWQpO1xyXG4gICAgICAgIHRoaXMuY2xpY2soaGVybyk7XHJcblxyXG4gICAgICAgIG1vZGVsLnN0ZXArKztcclxuICAgICAgICBtb2RlbC5hZGRQdWxsKGhlcm8pO1xyXG5cclxuICAgICAgICBpZiAobW9kZWwucHVsbEVuZGVkKSB7XHJcbiAgICAgICAgICAgIHZpZXcuZGlzYWJsZUdyaWQobW9kZWwucHVsbEVuZGVkKTtcclxuICAgICAgICAgICAgbW9kZWwuaGVyb2VzR3JpZC52aWV3LnNldFRhcmdldChudWxsKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMucHVsbEVuZCh0aGlzLl9tb2RlbC5wdWxsKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnB1bGwobW9kZWwuY3VyclBsYXllcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgSGVyb1B1bGwgeyBcclxuICAgIG1vZGVsOiBIZXJvUHVsbE1vZGVsO1xyXG4gICAgdmlldzogSGVyb1B1bGxWaWV3O1xyXG4gICAgY29udHJvbGxlciA6IEhlcm9QdWxsQ29udHJvbGxlcjtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihwbGF5ZXJzOiBzdHJpbmdbXSkge1xyXG4gICAgICAgIHRoaXMubW9kZWwgICAgICA9IG5ldyBIZXJvUHVsbE1vZGVsKHBsYXllcnMpO1xyXG4gICAgICAgIHRoaXMudmlldyAgICAgICA9IG5ldyBIZXJvUHVsbFZpZXcodGhpcy5tb2RlbCk7XHJcbiAgICAgICAgdGhpcy5jb250cm9sbGVyID0gbmV3IEhlcm9QdWxsQ29udHJvbGxlcih0aGlzLm1vZGVsLCB0aGlzLnZpZXcpO1xyXG5cclxuICAgICAgICB0aGlzLnZpZXcucmVuZGVyKCk7XHJcbiAgICB9XHJcblxyXG4gICAgb24oZXZlbnQ6IHN0cmluZywgY2FsbGJhY2s6IEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgdGhpcy5jb250cm9sbGVyW2V2ZW50XSA9IGNhbGxiYWNrO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG59Il19
